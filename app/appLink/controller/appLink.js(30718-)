(function() {   
    'use strict';   
    angular
        .module('AkosPCP.appLink')
        .controller('appLink', appLink);
    appLink.$inject = ['$scope','$http','$rootScope','$location','$window','$log','$cookieStore','$state','$uibModal','moment'];
    function appLink($scope,$http,$rootScope,$location,$window,$log,$cookieStore,$state,$uibModal,moment) {
        $log.log($location);
        //var vm = this;
        $rootScope.title = "AppLink"; 
        
        var ua = navigator.userAgent.toLowerCase();
        var isAndroid = ua.indexOf("android") > -1; //&& ua.indexOf("mobile");

        if(isAndroid) {
            $scope.appStore = "PLAY";
            if(typeof $state.params.thirdParty != 'undefined'){
                var url = "patientapp:///"+$state.params.roomID+'/'+$state.params.thirdParty;
            }else{
                var url = "patientapp:///"+$state.params.roomID+'/'+$state.params.type;
            }
        }else{
            $scope.appStore = "APP";
            if(typeof $state.params.thirdParty != 'undefined'){
                var url = "testAkos:///"+$state.params.roomID+'/'+$state.params.thirdParty; 
            }else{
                var url = "testAkos:///"+$state.params.roomID+'/'+$state.params.type; 
            }
            
           
        }
        
         var obj = {
            roomId: $state.params.roomID,
            type: $state.params.type,
            thirdParty: $state.params.thirdParty
        }
       // roomServices.saveUserConnectUrlstorage();
        localStorage.setItem("ConnectUrl", JSON.stringify(obj));


        $scope.downloadApp = function(){
            if(isAndroid) {
                
                window.location = "https://play.google.com/store/apps/details?id=com.akosmd.patientapp";        
            }else{
                
                window.location = "https://itunes.apple.com/us/app/akos/id1187895369?ls=1&mt=8";        
            }   
            
        }
        
        /*$scope.openApp = function(){
            
           window.location = url;
        }*/
        $scope.openApp = function () {
             //add this for connect url (07/23/2018)
            var url = "/#!/room/" + $state.params.roomID;

           window.location = url;
        }
        // setTimeout(function () { window.location = "https://itunes.apple.com/appdir"; }, 25);
        // 
    }
})();
 